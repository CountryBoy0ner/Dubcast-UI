<div class="chat-root">
  <div
    #messagesContainer
    class="chat-messages"
    (scroll)="onContainerScroll()"
    *ngIf="messages$ | async as msgs"
  >
    <div *ngIf="loadingPage" class="loading-older">
      <i class="pi pi-spin pi-spinner"></i> Loading history...
    </div>
    <ng-container *ngFor="let m of msgs">
      <app-chat-message [message]="m"></app-chat-message>
    </ng-container>
    <div *ngIf="msgs.length === 0" class="empty-state">No messages yet. Be the first!</div>
  </div>

  <div class="chat-input">
    <input
      [(ngModel)]="input"
      (keydown.enter)="send()"
      [disabled]="!(isAuthenticated$ | async)"
      [placeholder]="(isAuthenticated$ | async) ? 'Write a message...' : 'Log in to write'"
      autocomplete="off"
    />
    <button
      (click)="send()"
      [disabled]="!input.trim() || !(isAuthenticated$ | async)"
      class="send-btn"
    >
      <i class="pi pi-send"></i>
    </button>
  </div>
  <div *ngIf="!(isAuthenticated$ | async) && hint" class="chat-hint">{{ hint }}</div>
</div>
