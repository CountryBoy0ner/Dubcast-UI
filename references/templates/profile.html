<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Profile</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body class="page">

<header class="header">
    <div class="header__inner">
        <a href="/" class="logo">Dubcast</a>

        <nav class="nav">

            <a th:if="${!authenticated}" th:href="@{/login}" class="nav__link">Login</a>
            <a th:if="${!authenticated}" th:href="@{/register}" class="nav__link">Register</a>

            <span th:if="${authenticated}" class="nav__user">
                Logged in as <span th:text="${principalName}">user</span>
            </span>

            <a th:if="${authenticated}" th:href="@{/profile}" class="nav__link">My profile</a>

            <form th:if="${authenticated}"
                  th:action="@{/logout}" method="post"
                  style="display:inline; margin-left: 10px;">
                <input type="hidden"
                       th:name="${_csrf.parameterName}"
                       th:value="${_csrf.token}"/>
                <button type="submit"
                        class="nav__link"
                        style="border:none;background:none;cursor:pointer;">
                    Logout
                </button>
            </form>
        </nav>
    </div>
</header>

<main class="main">
    <section class="profile">
        <h1>Profile of <span th:text="${username}">user</span></h1>

        <p>Email: <span th:text="${email}">email@example.com</span></p>

        <h2>Bio</h2>
        <p th:if="${bio != null}" th:text="${bio}">no bio yet</p>
        <p th:if="${bio == null}">no bio yet</p>

        <div th:if="${canEdit}">
            <hr/>

            <h2>Edit username</h2>
            <form th:action="@{/profile/username}" method="post">
                <input type="hidden"
                       th:name="${_csrf.parameterName}"
                       th:value="${_csrf.token}"/>

                <input type="text"
                       name="username"
                       th:value="${username}"
                       placeholder="Username"/>

                <button type="submit">Save username</button>
            </form>

            <h2>Edit bio</h2>
            <form th:action="@{/profile/bio}" method="post">
                <input type="hidden"
                       th:name="${_csrf.parameterName}"
                       th:value="${_csrf.token}"/>

                <textarea name="bio"
                          rows="4"
                          cols="40"
                          placeholder="Tell something about yourself"
                          th:text="${bio}"></textarea>

                <button type="submit">Save bio</button>
            </form>

            <div th:if="${param.bioUpdated}">Bio updated.</div>
            <div th:if="${param.usernameUpdated}">Username updated.</div>
        </div>
    </section>
</main>

</body>
</html>
